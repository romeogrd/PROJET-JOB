<%- include('./partials/header') -%>
<div class="jobdetail-container">
<p><%= job.jobtitle %></p>
       
<p>Company : <%= job.company %></p>
<p>Website : <%= job.website %></p>
<div class="line"></div>
<p class="contactText">Contact of the employer</p>
<p>Name : <%= job.nameEmployer %></p>
<p>Email : <%= job.emailEmployer %></p>
<p>Phone : <%= job.phoneEmployer %></p>
<p>Adress : <%= job.adressEmployer %></p>
<div class="line"></div>
<p>Origin : <%= job.origin %></p>
<p>Status : <%= job.status %></p>
<p>Comment : <%= job.comments %></p>
<div class="button-container">
<p class="updateBtn"><a href="/jobupdate/<%= job._id %>">Update</a></p>
</div>

<p class="deleteBtn" data-job-id="<%= job._id %>"><a href="/">Delete</a></p>
</div>
<script>
    const deleteBtn = document.querySelector('.deleteBtn');
    const jobId = deleteBtn.getAttribute('data-job-id');

    deleteBtn.addEventListener('click', async () => {
    try {
        const res = await fetch(`/jobdetail/${jobId}`, {
            method: 'DELETE',
            headers: {
                'Content-Type': 'application/json'
            }
        });

        const data = await res.json();
        console.log(data);

        // Check if the deletion was successful before redirecting
        if (data.success) {
            // Redirect to the homepage
            window.location.href = '/';
        } else {
            console.error('Deletion failed:', data.error);
        }
    } catch (error) {
        console.error('Error:', error);
    }
});

</script>


<%- include('./partials/footer') -%>